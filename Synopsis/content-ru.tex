%!TEX root = ../dissertation.tex

\section*{Общая характеристика работы} %\addcontentsline{toc}{section}{Общая характеристика работы}

\input{common/characteristic-ru}

\newpage

\section*{СОДЕРЖАНИЕ РАБОТЫ}

Во \textbf{введении} обоснована актуальность научных исследований, проводимых в рамках данной диссертационной работы, описана степень разработки проблемы вывода демографической истории популяций по генетическим данным, обзор методов моделирования демографических историй, сформулированы цели и задачи, описаны научная новизна, теоретическая и практическая значимости работы, а также перечислены положения, выносимые на защиту.

В \underline{\textbf{первой главе}} приводится обзор предметной области, который включает определение демографической истории популяций, описание существующих методов вывода демографических историй популяций по генетическим данным.

В \textbf{разделе~1.1} описаны основные определения популяционной генетики, используемые в данной работе.
Она включает формальное определение демографической истории популяций.
Популяционная генетика является важной областью генетики, изучающей изменение генетического состава популяций и их эволюцию.
Она решает такие задачи, как определение структуры популяций, построение филогенетических деревьев и поиск демографической истории популяций.

%\emph{Популяция} --- это группа организмов одного вида, находящихся в определенной географической области и взаимодействующих друг с другом
%\emph{Эффективный размер популяции} $N_e$ --- это концепт, используемый для описания того, какой размер имела бы идеальная популяция с таким же уровнем генетического разнообразия, как и реальная популяция.
%Эффективный размер популяции $N_e$ обычно меньше, чем фактический размер популяции, однако, все же является более важной характеристикой популяции.
%\emph{Инбридинг} --- это образование потомства в результате размножения близкородственных особей.
%Он измеряется коэффициентом инбридинга, который отражает  степень близкородственных связей.

\emph{Демографическая история популяций} --- история эволюции и развития популяций, которая включает в себя информацию о том, как популяции делились и образовывались, какова была численность популяций, интенсивность миграции, \textit{коэффициенты инбридинга} --- степень близкородственных связей, и много другого.
Примеры визуального представления демографических историй представлены на рисунке~\ref{fig:syn_rus:dem_inf:dem_his_examples}.
Информация о численности популяций и миграциях отображена шириной закрашенных областей и стрелками между ними.
Время в демографических историях зачастую измеряется в поколениях или годах и отображено по оси ординат.
%Под \textit{численностью или размером популяции} в демографической истории понимается эффективный размер популяции --- концепт популяционной генетики, используемый для описания того, какой размер имела бы идеальная популяция с таким же уровнем генетического разнообразия, как и реальная популяция.
 
\begin{figure}[b]
    \centering
    \begin{subfigure}[b]{.33\textwidth}
    \includegraphics[width=\textwidth]{images/part1/dem_history/1d_model_fixed.pdf}
    \caption{}
    \labelsyn{fig:syn_rus:dem_inf:dem_his_examples_1}
    \end{subfigure}%
    \begin{subfigure}[b]{.33\textwidth}
    \includegraphics[width=\textwidth]{images/part1/dem_history/2d_model_isolation_fixed.pdf}
    \caption{}
    \labelsyn{fig:syn_rus:dem_inf:dem_his_examples_2}
    \end{subfigure}%
    \begin{subfigure}[b]{.33\textwidth}
    \includegraphics[width=\textwidth]{images/part1/dem_history/2d_model_migration_fixed.pdf}
    \caption{}
    \labelsyn{fig:syn_rus:dem_inf:dem_his_examples_3}
    \end{subfigure}
    \caption{Примеры визуального представления демографических историй одной и двух популяций}
    \labelsyn{fig:syn_rus:dem_inf:dem_his_examples}
\end{figure}

% В современной литературе нет определенности со строгим определением демографической истории.
% Приведем формальное определение демографической истории популяций, которое будет использовано в данной работе.

% \definition Демографическая история $\mathcal{D}$ для $P$ популяций --- это четверка ${\langle T, \mathfrak{G}, \mathfrak{M}, \mathcal{C} \rangle}$, где ${T = \langle V, E \rangle}$ --- полное бинарное дерево, в котором вершины ассоциированы с популяциями и которое определяет структуру разделения популяций, ${\mathfrak{G}: V \to \mathbb{R}_+ \times \mathbb{R}_+ \times \mathcal{F}_{\mathbb{R}_+ \to \mathbb{R}_+}}$ --- отображение, которое для каждой вершины~$v$ ставит в соответствие множество ${\langle t_v, t^d_v, g(t) \rangle}$, где $t_v$ и $t^d_v$ --- время образования и разделения популяции~$v$ соответственно, а функция ${g(t): [t_v, t^d_v] \to \mathbb{R}_+}$ определяет численность популяции в каждый момент ее существования, а ${\mathfrak{M} = \{\mathfrak{M}_q\},\ \mathfrak{M}_q \in \widetilde{\mathscr{M}} \cup \mathscr{M}}$ --- набор единичных и непрерывных миграций, $\mathcal{C}: V \to \mathbb{R}^C$ --- набор дополнительных констант для популяций.

% На отображение $\mathfrak{G}$ накладывается следующее ограничение: для любой вершины $v$ время ее образования $t_v$ равно времени разделения $t^d_{parent(v)}$ ее вершины-родителя.
% Для любой единичной миграции ${\mathfrak{M}_q = \langle v_1, v_2, t, m \rangle}$ выполняется: ${v_1, v_2 \in V}$ и $t \in [t_{v_1}, t^d_{v_1}] \cap [t_{v_2}, t^d_{v_2}]$.
% Для любой непрерывной миграции ${\mathfrak{M}_q = \langle v_1, v_2, t^s, t^e, m \rangle}$ выполняется: ${v_1, v_2 \in V}$ и ${t^s, t^e \in [t_{v_1}, t^d_{v_1}] \cap [t_{v_2}, t^d_{v_2}]}$.
% В качестве дополнительных констант для популяций в данной работе будут рассмотрены коэффициенты инбридинга $\mathcal{C}(v_i) = F_i,\ i=1,\ldots,P$, заданные для листьев $\{v_i\}_{i=1}^P$ дерева $T$.

% Рисунок~\ref{fig:syn:dem_def} демонстрирует пример демографической истории популяций как набора из дерева разделений, отображения на его вершинах, множества миграций и констант.

% \begin{figure}[ht]
%     \centering
%     \includegraphics[width=0.9\textwidth]{images_2/dem_hist_def.pdf}
%     \caption{Пример демографической истории популяций как множества из дерева разделений с заданными временами и функциями численности, набора миграций и дополнительных констант}
%     \labelsyn{fig:syn:dem_def}
% \end{figure}



\newpage
В \textbf{разделе 1.2} описана постановка задачи вывода демографической истории популяций по генетическим данным с использованием параметрических моделей, а также описаны основные компоненты существующих методов решения этой задачи.
В разделе приведено краткое описание известных программных средств, реализующих эти методы, а именно \dadi, \moments, \momi и \momentsLD.

Для вывода демографической истории популяций используются параметрические модели, которые представляют собой \textit{метрические деревья с функциями на ребрах}.
Использование моделей позволяет, во-первых, ограничить пространство поиска, а, во-вторых, использовать методы оптимизации для настройки значений их параметров по генетическим данным.
На рисунке~\ref{fig:model_def2} изображен пример модели в виде метрического дерева с функциями на ребрах, которое описывает демографическую историю двух популяций.

\begin{figure}[ht]
    \centering
    \includegraphics[width=0.7\textwidth]{images/part1/2d_model_metric_tree_2.pdf}
    \caption{Пример модели демографической истории двух популяции в виде метрического дерева с функциями на ребрах}
    \labelsyn{fig:model_def2}
\end{figure}

Задача вывода демографической истории популяций по генетическим данным заключается в \textit{настройке параметров} заданной модели --- поиске параметров, обеспечивающих максимальное значение функции правдоподобия генетических данных (рисунок~\ref{fig:part1:deminf:general_scheme}).
Существующие программные решения отличаются интерфейсами спецификации моделей, методами вычисления правдоподобия и методами оптимизации для настройки параметров.

\begin{figure}[ht]
    \includegraphics[width=0.6\textwidth]{images/part1/dem_history/general_scheme.pdf}
    \caption{Пример входа и выхода существующих программных решений для вывода демографической истории популяций по генетическим данным}
    \labelsyn{fig:part1:deminf:general_scheme}
\end{figure}


В \textbf{разделе 1.3} описаны два класса моделей демографических историй, которые применяются в существующих решениях, а также методы сравнения моделей с разным числом параметров.

\textit{Модели первого класса} используются в программных решениях \dadi, \moments и \momentsLD.
Они представляются в виде последовательности элементов временных интервалов, разделений, единичных миграций и элементов инбридинга (рисунок~\ref{fig:dadi:model_spec}).
Они имеют только непрерывные параметры, а динамики изменения численности (константная численность, линейное или экспоненциальное изменение) в этих моделях всегда фиксированы.

\begin{figure}[b]
    \centering
    \includegraphics[width=\linewidth]{images_2/dadi_model.pdf}
    \caption{Пример задания модели первого класса с использованием интерфейса библиотеки~\dadi}
    \labelsyn{fig:dadi:model_spec}
\end{figure}


\textit{Модели второго класса} применяются в программном решении \momi.
Они представляются в виде набора событий изменения численности, разделения популяций и единичных миграций.
Модели второго класса также включают только непрерывные параметры и имеют фиксированные динамики изменения численности.
Однако они являются более ограниченными по сравнению с моделями первого класса, например, не поддерживают линейное изменение численности или непрерывные миграции.

Проблема выбора модели в общем случае состоит в том, что необходимо выбрать наиболее подходящую модель для данных.
Если выбрана слишком простая модель --- с малым числом параметров, она может не отображать всю информацию из данных.
Если выбрана слишком сложная модель --- с большим числом параметров, она может переобучиться на шуме в данных и в итоге неправильно моделировать реальный процесс.
Для сравнения различных моделей и выбора наилучшей используют  информационный критерий Акаике (AIC)~\cite{akaike1974new}, байесовский информационный критерий (BIC)~\cite{schwarz1978estimating} и тест отношения правдоподобия~\cite{vuong1989likelihood}.

В \textbf{разделе 1.4} приведено описание существующих методов вычисления правдоподобия генетических данных при условии заданной демографической истории.
В раздел включены определения основных понятий биологии и генетики, например, ДНК, генов, аллелей и генотипов.
Также описаны основные используемые статистики данных: аллель-частотный спектр и статистики на основе неравномерного сцепления генов.
Наконец, приведено описание методов вычисления правдоподобия, реализованных в программных решениях \dadi, \moments, \momi и \momentsLD.

\textbf{Раздел 1.5} содержит общее описание методов локальной и глобальной оптимизации, основные отличия этих двух групп, а также обзор существующих методов оптимизации для настройки параметров моделей демографических историй по генетическим данным.
Преимущественно применяются методы локальной оптимизации такие, как метод Бройдена-Флетчера-Гольдфарба-Шанно (BFGS)~\cite{broyden1970convergence,fletcher1970new, goldfarb1970family,shanno1970conditioning}, метод Нелдера-Мида~\cite{nelder1965simplex} и метод Пауэлла~\cite{powell1964efficient}~(рисунок~\ref{fig:syn_ru:opt:opt_example}).
% Программные решения \textit{dadi pipeline}~\cite{portik2017evaluating} и \textit{moments pipeline}~\cite{leache2019exploring} реализуют алгоритм последовательных раундов метода Нелдера-Мида для оптимизации функции правдоподобия \dadi и \moments соответственно.
% Также после первой нерецензируемой публикации диссертанта в 2019 году в \dadi был реализован первый алгоритм глобальной оптимизации BOBYQA~\cite{powell2009bobyqa, blischak2020inferring}.
Существующие методы оптимизации для настройки параметров моделей ограничены выводом значений только непрерывных параметров и требуют вовлечения пользователя для задания начальных значений параметров модели и гиперпараметров метода, например, числа перезапусков.
Использование методов локальной оптимизации не гарантирует нахождение глобального оптимума.

\begin{figure}[hb]
    \begin{subfigure}[b]{\linewidth}
    \centering
    \includegraphics[height=3.2cm]{images/part1/opt/example_3d.png}
    \caption{}
    \labelsyn{fig:syn_ru:opt:opt_example_3d}
    \end{subfigure}
    \begin{subfigure}[b]{.33\linewidth}
    \includegraphics[height=3.2cm]{images/part1/opt/example_bfgs.png}
    \caption{}
    \labelsyn{fig:syn_ru:opt:opt_example_bfgs}
    \end{subfigure}%
    \begin{subfigure}[b]{.33\linewidth}
    \includegraphics[height=3.2cm]{images/part1/opt/example_nelder_mead.png}
    \caption{}
    \labelsyn{fig:syn_ru:opt:opt_example_nelder_mead}
    \end{subfigure}%
    \begin{subfigure}[b]{.33\linewidth}
    \includegraphics[height=3.2cm]{images/part1/opt/example_powell.png}
    \caption{}
    \labelsyn{fig:syn_ru:opt:opt_example_powell}
    \end{subfigure}
    \caption{Примеры работы методов локальной оптимизации при поиске максимума функции, изображенной на рисунке (а): (б) метод BFGS, (в) метод Нелдера-Мида, (г) метод Пауэлла.}
    \labelsyn{fig:syn_ru:opt:opt_example}
\end{figure}

В \textbf{разделе 1.6} приведены существующие методы перебора моделей демографической истории популяций, а также модификации подходов сравнения моделей с разным числом параметров в условиях зависимости генетических данных.
На момент начала исследований в 2017 году не существовало метода автоматического перебора моделей демографической истории популяций.
Все сравнения моделей проводились пользователем вручную с использованием информационного критерия Акаике или теста отношения правдоподобия.
После публикации первой статьи~\cite{noskova2020gadma} диссертанта появилось единственное программное средство~\cite{rippe2021environmental}, реализующее аналог метода автоматического перебора моделей.
Однако он ограничен анализом двух популяций и предполагает независимость данных.
В общем случае, генетические данные имеют зависимости: определенные части генома наследуются вместе.
Если данные зависимы, то информационный критерий Акаике и тест отношения правдоподобия будут ошибочно отдавать предпочтение моделям с большим числом параметров~\cite{gao2010composite}.
Существующие модификации этих конструкций~\cite{coffman2016computationally} позволяют учитывать эти зависимости.



Во \underline{\textbf{второй главе}} описаны разработанный расширенный класс моделей демографических историй, методы настройки их параметров на основе комбинации методов глобальной и локальной оптимизации, а также экспериментальные исследования разработанных моделей и методов.

\textbf{Раздел 2.1} содержит описание разработанного класса расширенных моделей демографической истории, реализацию этих моделей и примеры использования.
В качестве прототипа был выбран первый класс моделей.
Разработанные модели включают новый тип параметров для настройки --- дискретные параметры динамики изменения численности, которые могут представляться одной из трех зависимостей: постоянная численность, линейное или экспоненциальное изменение.
Изображение предложенной модели, а также демографические истории при разных значениях параметра \texttt{Dyn} показаны на рисунке~\ref{fig:new_model:model}.

\begin{figure}[ht]
    \centering
    \includegraphics[width=\linewidth]{images_2/picture_2pops_model_3.pdf}
    \caption{Пример расширенной модели демографической истории двух популяций и демографические истории при разных значениях параметра \texttt{Dyn}}
    \labelsyn{fig:new_model:model}
\end{figure}



В \textbf{разделе 2.2} приведено формальное описание разработанного метода настройки параметров моделей расширенного класса на основе комбинации генетического алгоритма и метода локального поиска.
Описаны общая схема, разработанные операторы мутации и скрещивания в генетическом алгоритме, реализация и примеры применения предложенного метода.
Кроме того, в разделе приведены результаты автоматической настройки гиперпараметров генетического алгоритма для более эффективного решения поставленной задачи.

\textbf{Раздел 2.3} описывает второй разработанный метод настройки параметров моделей расширенного класса --- на основе комбинации байесовской оптимизации и метода локального поиска.
Приведено описание байесовской оптимизации и ее компонент, существующего метода кросс-валидации для выбора некоторых гиперпараметров, а также реализации разработанного метода.
Как и в случае с генетическим алгоритмом, были настроены гиперпараметры байесовской оптимизации.
Проведены экспериментальные исследования для ручной настройки, на основе которых была предложена ансамблевая байесовская оптимизация.

\textbf{Раздел 2.4} включает экспериментальные исследования разработанного метода настройки параметров на основе комбинации генетического алгоритма и локального поиска.

Сначала были проведены экспериментальные исследования разработанного метода в сочетании с методом вычисления правдоподобия, реализованным в \moments.
Проведено сравнение разработанного метода с методом Пауэлла с перезапусками и методом последовательных запусков метода Нелдера-Мида, реализованным в \textit{moments-pipeline}.
Для сравнения использовались модели первого класса и три набора симулированных данных.
Сравнение показало, что разработанный метод (GA) позволяет более эффективно настраивать параметры моделей (таблица~\ref{tab:part2:experiments:simulated_3:results}).
Дополнительно были рассмотрены предложенные расширенные модели и была проведена настройка их параметров с использованием разработанного метода.
Метод позволил корректно настроить параметры расширенных моделей, включая динамики изменения численности популяций.

\begin{table}[bh!]
    \caption{Результаты экспериментальных исследований сравнения методов настройки параметров на симулированных данных трех популяций}
    \resizebox{\linewidth}{!}{
    \begin{tabular}{|l | c | c | c |}
    \hline
    & Метод Пауэлла  & \multirow{2}{*}{\textit{moments-pipeline}} & \multirow{2}{*}{GA}\\
    & с перезапусками & & \\ 
    \hline
    Среднее число вычислений &  $22{\,}475$ & $19{\,}452$ & $21{\,}651$ \\
    \hline
    Среднее $f^{\text{\moments}}$ &$-11{\,}178{,}62$ & $-11{\,}179{,}82$ & $\mathbf{-11{\,}178{,}45}$\\
    \hline
    Стандартное & $0{,}40$ & $0{,}72$ & $\mathbf{0{,}15}$\\
    отклонение $f^{\text{\moments}}$ & & & \\
    \hline 
    Лучшее $f^{\text{\moments}}$ & $-11{\,}178{,}31$ & $-11{\,}178{,}59$ & $\mathbf{-11{\,}178{,}29}$\\
    \hline
    \end{tabular}%
    }
    \labelsyn{tab:part2:experiments:simulated_3:results}
\end{table}


Затем были проведены три экспериментальных исследования разработанного метода в сочетании с методом вычисления правдоподобия, реализованным в \dadi.

Метод был применен для реальных данных популяций кошачьей лягушки (\textit{Scotobleps gabonicus}), которые ранее были проанализированы в~\cite{portik2017evaluating} с применением \textit{dadi-pipleine}.
Для трех различных пар популяций были получены демографические истории с использованием тех же 12 моделей, которые были использованы в~\cite{portik2017evaluating}.
Для 92\% моделей разработанный метод нашел параметры с большим значением правдоподобия, чем было получено с применением \textit{dadi-pipleine}.
В 5\% случаев правдоподобие совпало и только для одной модели (3\%) оно оказалось хуже.

На данных двух популяций американской пумы (\textit{Puma concolor}) разработанный метод был сравнен с методом BFGS с перезапусками и методов BOBYQA с перезапусками.
Использовались две модели, предложенные и проанализированные ранее в работе~\cite{blischak2020inferring}, без инбридинга и с инбридингом.
Показано, что разработанный метод в среднем оказывается более эффективным, чем методы BFGS и BOBYQA (таблица~\ref{tab:part2:experiments:puma:puma_F_res}).
Дополнительная настройка параметров моделей с использованием расширенной области значений параметров позволила получить демографическую историю, имеющую значение правдоподобия выше, чем было получено ранее.

\begin{table}[ht]
    \centering
    \caption{Результаты 100 запусков различных методов для поиска параметров модели с инбридингом для вывода демографической истории двух популяций пум}
    \resizebox{\linewidth}{!}{%
    \begin{tabular}{|p{3.3cm}|P{1.9cm}|P{1.9cm}|P{1.9cm}|P{1.9cm}|P{1.9cm}|}
         \hline
         & \multicolumn{2}{c|}{BFGS} &  \multicolumn{2}{c|}{BOBYQA} & GA \\
         &  1 запуск & 16 запусков & 1 запуск & 4 запуска &\\
         \hline
         Число вычислений правдоподобия & $394\pm82$ & $6{\,}245\pm324$ & $1{\,}605 \pm 1{\,}207$ & $6{\,}095 \pm 2{\,}561$ & $6{\,}193\pm2{\,}680$ \\
         \hline
         Время CPU (мин.) &  $1{,}3\pm1{,}4$ & $25\pm19$ & $ 12\pm 5$ & $16\pm7$ & $93\pm47$ \\
         \hline
         Лучшее правдоподобие &  $-317{\,}370{,}88$ & $-317{\,}370{,}88$ & $\mathbf{-317{\,}239{,}48}$ & $\mathbf{-317{\,}239{,}48}$ & $-317{\,}239{,}49$ \\
         \hline
         Среднее правдоподобие &  $-1{\,}729{\,}870$ & $-320{\,}947$ & $-381{\,}979$ & $-320{\,}503$ & $\mathbf{-319{\,}451}$ \\
         \hline
         Стандартное отклонение правдоподобия & $4{\,}339{\,}276$ & $5{\,}029$ & $115{\,}205$ & $8{\,}753$ & $7{\,}340$ \\
         \hline
    \end{tabular}%
    }
    \labelsyn{tab:part2:experiments:puma:puma_F_res}
\end{table}

Аналогичным образом разработанный метод был сравнен с методом BOBYQA с перезапусками на данных огородной капусты (\textit{Brassica oleracea}), которые ранее были   проанализированы в работе~\cite{blischak2020inferring}.
На этих данных метод BOBYQA с множественными запусками показал результаты лучше, чем разработанный метод, однако, отметим, что число перезапусков, необходимых для достижения эффективности метода BOBYQA, остается неизвестным в общем случае.
Было рассмотрено расширенное пространство значений параметров, что позволило получить демографические истории, имеющие лучшее значение правдоподобия, чем получено ранее.

Затем, четыре существующих метода вычисления правдоподобия, реализованные в \dadi, \moments, \momi и \momentsLD, были сравнены с использованием разработанного метода на данных орангутанга, симулированных с использованием библиотеки \textit{stdpopsim}~\cite{adrion2020community,lauterbur2023expanding}.
Сравнение было проведено с применением различных моделей, включая модели расширенного класса.
Было показано, что все методы позволяют восстановить исходную демографическую историю при применении корректных моделей.
Использование моделей, которые не способны отразить исходную историю, например, не включающих непрерывные миграции, приводит к различиям в получаемых результатах (рисунок~\ref{fig:part2:experiments:sim2:results:oran_momi}).
Однако отметим, что основные характеристики популяций такие, например, как численность, настраиваются корректно и в таком случае.

\begin{figure}[ht]
    \centering
    \begin{subfigure}[b]{0.24\linewidth}
        \centering
        \includegraphics[width=\textwidth]{images_experiments/suimulation_2_stdpopsim/ORAN-PULSE/oran-nomig.pdf}
        \caption{}
        \labelsyn{fig:part2:experiments:sim2:results:oran_momi_nomig}
    \end{subfigure}%
    \begin{subfigure}[b]{0.24\linewidth}
        \centering
        \includegraphics[width=\textwidth]{images_experiments/suimulation_2_stdpopsim/ORAN-PULSE/oran-pulse-1.pdf}
        \caption{}
        \labelsyn{fig:part2:experiments:sim2:results:oran_pulse_1}
    \end{subfigure}%
    \begin{subfigure}[b]{0.24\linewidth}
        \centering
        \includegraphics[width=\textwidth]{images_experiments/suimulation_2_stdpopsim/ORAN-PULSE/oran-pulse-3.pdf}
        \caption{}
        \labelsyn{fig:part2:experiments:sim2:results:oran_pulse_3}
    \end{subfigure}%
    \begin{subfigure}[b]{0.24\linewidth}
        \centering
        \includegraphics[width=\textwidth]{images_experiments/suimulation_2_stdpopsim/ORAN-PULSE/oran-pulse-7.pdf}
        \caption{}
        \labelsyn{fig:part2:experiments:sim2:results:oran_pulse_7}
    \end{subfigure}
    \caption{Результаты настроенных моделей для метода вычисления правдоподобия, реализованного в \momi (а)~модель без миграций, и модели с (б)~одной, (в)~тремя, (г)~семью единичными миграциями}
    \labelsyn{fig:part2:experiments:sim2:results:oran_momi}
\end{figure}

Наконец, была выведена демографическая история трех популяций современного человека на территории России: жителей Пскова, Новгорода и Якутии.
Используемые данные ранее не были проанализированы.
Параметры расширенной модели были настроены с помощью разработанного метода на основе комбинации генетического алгоритма и локального поиска.
Полученная демографическая история (рисунок~\ref{fig:part2:experiments:rus:result}) согласуется с известной историей современного человека~\cite{schraiber2015methods, nielsen2017tracing}.

\begin{figure}[hb]
    \centering
        \includegraphics[width=0.7\linewidth]{images_experiments/rus_genomes/picture_result.pdf}
    \caption{Полученная демографическая история трех популяций современного человека}
    \labelsyn{fig:part2:experiments:rus:result}
\end{figure}

\textbf{Раздел 2.5} описывает результаты экспериментальных исследований разработанного метода настройки параметров моделей на основе комбинации байесовской оптимизации и локального поиска.

Байесовская оптимизация была сравнена с генетическим алгоритмом  на множестве наборов данных (рисунок~\ref{fig:bo_ga_comp}).
Было показано, что генетический алгоритм (GA) оказывается более эффективным в случае одной, двух и трех популяций.
Байесовская оптимизация (BO) имеет более быструю сходимость, чем генетический алгоритм, если рассматривается более трех популяций.
Применение байесовской оптимизации позволяет сократить время настройки параметров моделей на 50-80\%, что приводит к значительному ускорению процесса на дни и даже недели.

\begin{figure}[ht]
    \centering
    \begin{subfigure}[b]{0.49\linewidth}
        \centering
        \includegraphics[width=0.87\textwidth]{images_experiments/bo_ga/2_BotDivMig_8_Sim_bo_ga_time.pdf}
        \caption{}
        \labelsyn{fig:bo_ga_comp:2pops}
    \end{subfigure}%
    \begin{subfigure}[b]{0.49\linewidth}
        \centering
        \includegraphics[width=0.87\textwidth]{images_experiments/bo_ga/5_YRI_CEU_CHB_JPT_KHV_21_Jou_bo_ga_time.pdf}
        \caption{}
        \labelsyn{fig:bo_ga_comp:5pops}
    \end{subfigure}
    \caption{Сходимость по времени методов настройки параметров моделей для (а) двух популяций, (б)~пяти популяций}
    \labelsyn{fig:bo_ga_comp}
\end{figure}

Также разработанный метод на основе комбинации байесовской оптимизации и метода локального поиска был использован для настройки параметров моделей демографических историй четырех и пяти популяций современного человека по реальным данным из статьи~\cite{jouganous2017inferring}.
Разработанный метод позволил получить параметры, которые дают лучшее значение правдоподобия, чем найденные в~\cite{jouganous2017inferring} с помощью метода Пауэлла с перезапусками.
Сравнение полученной демографической истории с более высоким значением правдоподобия и истории, полученной в оригинальной статье, представлено на рисунке~\ref{fig:syn_ru:bo_human}.
\begin{figure}[h!]
    \centering
    \includegraphics[width=0.8\linewidth]{images_experiments/bo_human/4pops_base.pdf}
    \caption{Сравнение демографической истории, полученной разработанным методом (BO), и демографической истории из~\cite{jouganous2017inferring}}
    \labelsyn{fig:syn_ru:bo_human}
\end{figure}


В \underline{\textbf{третьей главе}} описан разработанный метод автоматического перебора расширенных моделей демографической истории одной, двух и трех популяций, а также результаты его применения в сочетании с разработанным методом на основе комбинации генетического алгоритма и локального поиска.

В \textbf{разделе 3.1} приведено формальное описание разработанного метода.
На вход подаются минимальные и максимальные ограничения на модель.
На первом раунде метод строит модель, удовлетворяющую минимальным ограничением и выполняет настройку ее параметров с применением разработанного метода на основе генетического алгоритма.
На каждом следующем раунде происходит изменение модели, увеличение числа ее параметров и последующая настройка нового набора параметров.
Работа метода останавливается, когда модель достигает максимальных ограничений.
В конце происходит сравнение всех перебранных моделей с использованием информационного критерия Акаике и выбирается наилучшая.
В качестве ограничений на модели было предложено число временных интервалов.

В \textbf{разделе 3.2} приведены экспериментальные исследования разработанного метода автоматического перебора моделей.
Для генетических данных трех популяций современного человека была получена демографическая история «выхода из Африки», представленная на рисунке~\ref{fig:part4:experiments:3pop_human:result}.
Она согласуется с другими исследованиями~\cite{gutenkunst2009inferring, schraiber2015methods, nielsen2007recent} и имеет не только наилучшее значение правдоподобия, чем история, полученная ранее в~\cite{gutenkunst2009inferring} по тем же данным, но и лучшее значение информационного критерия Акаике.

\begin{figure}[ht]
    \centering
        \includegraphics[width=0.8\textwidth]{images_experiments/3pop_human_gutenkunst/picture_3pop_result.pdf}
    \caption{Демографическая история, полученная разработанным методом}
    \labelsyn{fig:part4:experiments:3pop_human:result}
\end{figure}

Для трех наборов генетических данных популяции кошачьей лягушки (\textit{Scotobleps gabonicus}), на которых были построены модели в разделе 2.4 данной работы с использованием метода ручного перебора, также были получены модели демографических историй с использованием разработанного метода автоматического перебора.
Из двух наборов данных полученные модели показали наилучшее значение информационного критерия Акаике среди всех рассмотренных конфигураций.
В случае третьего набора данных полученная модель имеет значение информационного критерия Акаике, которое хуже, чем у лучшей модели, полученной в результате ручного перебора. Тем не менее, результаты позволяют выявить излишний параметр модели, и исключение этого параметра из конфигурации приводит к наилучшему значению информационного критерия Акаике.

Разработанный метод автоматического перебора расширенных моделей был использован при выводе демографической истории популяций голубой акулы.
Генетические данные ранее не были проанализированы.
Был разработан подход последовательного вывода демографической истории двух и трех популяций, в результате которого была получена демографическая история, представленная на рисунке~\ref{fig:part2:experiments:blue_shark:3pop_hist}.
Полученные численности популяций согласуются с другими исследованиями~\cite{king2015genetic,verissimo2017world}.
Апробация результатов, проведенная коллегами из области зоологии, позволила предположить, что разделение северной и южной популяций произошло в связи с палеоклиматическими событиями в эпоху голоцена~\cite{leduc2010holocene,masson2013information,olsen2012variability}.

\begin{figure}[ht]
    \centering
        \includegraphics[width=0.6\linewidth]{images_experiments/blue_shark/3pop_history.pdf}
    \caption{Демографическая история трех популяций голубой акулы}
    \labelsyn{fig:part2:experiments:blue_shark:3pop_hist}
\end{figure}

В \underline{\textbf{четвертой главе}} приведено описание программных комплексов, которые реализовывают разработанные методы или были использованы в данной работе. 

\textbf{Раздел 4.1} содержит описание программного комплекса GADMA (Global seach Algorithm for Demographic Model Analysis), который реализует разработанные модели расширенного класса, методы настройки параметров этих моделей и метод автоматического перебора расширенных моделей.
Структура программного комплекса представлена на рисунке~\ref{fig:syn_ru:gadma_modules}.

\begin{figure}[ht]
    \centering
    \includegraphics[width=\linewidth]{images/part5/gadma_modules.pdf}
    \caption{Структура программного комплекса GADMA}
    \labelsyn{fig:syn_ru:gadma_modules}
\end{figure}

В \textbf{разделе 4.2} приведено описание расширения библиотек \textit{stdpopsim} и \textit{demes}.
Библиотека \textit{stdpopsim} содержит каталог предопределенных видов и их демографических историй для более надежных симуляций генетических данных.
Эта библиотека была расширена и использована при проведении экспериментальных исследований.
Программное средство \textit{demes} предназначено для текстового и визуального представления демографических историй.
Эта библиотека была расширена реализацией линейного изменения численности популяции, а также была интегрирована в программный комплекс GADMA.
Все изображения демографических историй в данной диссертации были получены с использованием библиотеки \textit{demes}.

В \textbf{заключении} приведены основные результаты работы, которые состоят в следующем:
\input{common/concl-ru}